{% extends 'base_content.html' %}
{% load static %}

{% block body_class %}find-users-bg{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'find_users.css' %}">
<link rel="stylesheet" href="{% static 'navbar.css' %}">
<link rel="stylesheet" href="{% static 'dashboard.css' %}">
{% endblock %}

{% block content %}

<!-- Dust particles -->
<div class="find-users-particles">
  {% for _ in "123456789012345678901234567890" %}
    <span></span>
  {% endfor %}
</div>

<div class="container">
  <div class="row">
    <div class="col-12">
      <h1>Find Users</h1>
      
      <!-- Search Bar -->
      <div class="search-card">
        <form method="get" action="">
          <div class="input-group">
            <span class="input-group-text">
              <i class="bi bi-search"></i>
            </span>
            <input 
              type="text" 
              class="form-control" 
              name="search"
              placeholder="Search by username or name..."
              autocomplete="off"
              value="{{ search_query }}"
            >
          </div>
        </form>
        <small class="text-muted">
          Search for users by username, first name, or last name
        </small>
      </div>

      <!-- Results Count -->
      {% if search_query %}
      <div class="results-count">
        <span class="badge">{{ page_obj.paginator.count }} user{{ page_obj.paginator.count|pluralize }} found</span>
      </div>
      {% endif %}

      <!-- User List -->
      <div class="user-grid">
        {% for user in users %}
        <div class="user-card-item" data-user-id="{{ user.id }}">
          <img 
            src="{{ user.mini_gravatar }}" 
            alt="{{ user.username }}" 
            class="user-avatar"
          >
          <div class="user-info">
            <h6 class="user-name">{{ user.full_name }}</h6>
            <p class="user-username">{{ user.username }}</p>
          </div>
          <div class="user-actions">
            <a href="{% url 'user_profile' user.id %}" class="filters-apply-btn">
              View Profile
            </a>
          </div>
        </div>
        {% empty %}
        <div class="col-12">
          <div class="alert alert-info">
            <i class="bi bi-info-circle"></i> No users found.
          </div>
        </div>
        {% endfor %}
      </div>

      <!-- Pagination -->
      {% if is_paginated %}
        <nav aria-label="User pagination" class="mt-4">
          <ul class="pagination justify-content-center dashboard-pagination">
            {% if page_obj.has_previous %}
              <li class="page-item">
                <a class="page-link" href="?page={{ page_obj.previous_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}" aria-label="Previous">
                  <span aria-hidden="true">&laquo;</span>
                </a>
              </li>
            {% else %}
              <li class="page-item disabled">
                <span class="page-link" aria-hidden="true">&laquo;</span>
              </li>
            {% endif %}

            {% for num in page_obj.paginator.page_range %}
              {% if num == page_obj.number %}
                <li class="page-item active" aria-current="page">
                  <span class="page-link">{{ num }}</span>
                </li>
              {% else %}
                <li class="page-item">
                  <a class="page-link" href="?page={{ num }}{% if search_query %}&search={{ search_query }}{% endif %}">{{ num }}</a>
                </li>
              {% endif %}
            {% endfor %}

            {% if page_obj.has_next %}
              <li class="page-item">
                <a class="page-link" href="?page={{ page_obj.next_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}" aria-label="Next">
                  <span aria-hidden="true">&raquo;</span>
                </a>
              </li>
            {% else %}
              <li class="page-item disabled">
                <span class="page-link" aria-hidden="true">&raquo;</span>
              </li>
            {% endif %}
          </ul>
        </nav>
      {% endif %}
    </div>
  </div>
</div>

{% endblock %}