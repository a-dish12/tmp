{% extends "base_content.html" %}
{% block content %}

<div class="mb-3">
  <h1>Plan meals for {{ day_date }}</h1>
</div>

<div class="mb-3">
  <a href="{% url 'planner_range' %}" class="btn btn-outline-secondary btn-sm">← Back to Planner</a>
  <a href="{% url 'dashboard' %}" class="btn btn-secondary btn-sm">← Back to Dashboard</a>
</div>

{# Create new recipe and come back here #}
<p>
  <a href="{% url 'create_recipe' %}?next={% url 'planner_day' day_date|date:'Y-m-d' %}">
    + Create a new recipe
  </a>
</p>

<hr>

<h2>Add a meal</h2>
<form method="post">
  {% csrf_token %}
  {{ form.as_p }}
  <button type="submit">Add</button>
</form>

<hr>

<h2>Planned meals</h2>

{% if meals %}
  <h3>Breakfast</h3>
  <ul>
    {% for m in meals %}
      {% if m.meal_type == "breakfast" %}
        <li class="mb-2">
          <a href="{% url 'recipe_detail' m.recipe.pk %}">{{ m.recipe }}</a>
          <form method="post" action="{% url 'remove_from_calendar' m.pk %}" style="display: inline;">
            {% csrf_token %}
            <button type="submit" class="btn btn-sm btn-outline-danger">Remove</button>
          </form>
        </li>
      {% endif %}
    {% endfor %}
  </ul>

  <h3>Lunch</h3>
  <ul>
    {% for m in meals %}
      {% if m.meal_type == "lunch" %}
        <li class="mb-2">
          <a href="{% url 'recipe_detail' m.recipe.pk %}">{{ m.recipe }}</a>
          <form method="post" action="{% url 'remove_from_calendar' m.pk %}" style="display: inline;">
            {% csrf_token %}
            <button type="submit" class="btn btn-sm btn-outline-danger">Remove</button>
          </form>
        </li>
      {% endif %}
    {% endfor %}
  </ul>

  <h3>Dinner</h3>
  <ul>
    {% for m in meals %}
      {% if m.meal_type == "dinner" %}
        <li class="mb-2">
          <a href="{% url 'recipe_detail' m.recipe.pk %}">{{ m.recipe }}</a>
          <form method="post" action="{% url 'remove_from_calendar' m.pk %}" style="display: inline;">
            {% csrf_token %}
            <button type="submit" class="btn btn-sm btn-outline-danger">Remove</button>
          </form>
        </li>
      {% endif %}
    {% endfor %}
  </ul>

  <h3>Snack</h3>
  <ul>
    {% for m in meals %}
      {% if m.meal_type == "snack" %}
        <li class="mb-2">
          <a href="{% url 'recipe_detail' m.recipe.pk %}">{{ m.recipe }}</a>
          <form method="post" action="{% url 'remove_from_calendar' m.pk %}" style="display: inline;">
            {% csrf_token %}
            <button type="submit" class="btn btn-sm btn-outline-danger">Remove</button>
          </form>
        </li>
      {% endif %}
    {% endfor %}
  </ul>
{% else %}
  <p>No meals planned yet for this day.</p>
{% endif %}

{% endblock %}
